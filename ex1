import fitz

def extract_text_with_formatting(pdf_path):
    text_with_formatting = []
    with fitz.open(pdf_path) as doc:
        for page in doc:
            blocks = page.get_text("blocks")
            for b in blocks:
                for l in b:
                    text_with_formatting.append({
                        "text": l[4],  # Extract text
                        "font": l[0],  # Font information
                        "size": l[1],  # Font size
                        "color": l[2],  # Text color
                        "style": l[3],  # Text style (e.g., bold, italic)
                        "bbox": l[4],   # Bounding box
                    })
    return text_with_formatting

def find_formatting_changes(old_pdf_path, new_pdf_path):
    old_text = extract_text_with_formatting(old_pdf_path)
    new_text = extract_text_with_formatting(new_pdf_path)

    # Compare formatting between old and new versions
    changes = []
    for old_line, new_line in zip(old_text, new_text):
        if old_line["text"] != new_line["text"]:
            # Text content has changed
            changes.append({
                "old_text": old_line["text"],
                "new_text": new_line["text"],
                "old_format": old_line,
                "new_format": new_line,
            })

    return changes

old_pdf_path = "old_document.pdf"
new_pdf_path = "new_document.pdf"
formatting_changes = find_formatting_changes(old_pdf_path, new_pdf_path)
print(formatting_changes)
