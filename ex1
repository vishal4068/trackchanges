import fitz  # PyMuPDF

def extract_pages_with_red_text(pdf_path, output_path):
    # Open the PDF
    pdf_document = fitz.open(pdf_path)

    # Create a new PDF
    new_pdf = fitz.open()

    # Iterate through each page of the PDF
    for page_number in range(pdf_document.page_count):
        page = pdf_document.load_page(page_number)
        
        # Iterate through each text span on the page
        for text_instance in page.get_text("dict")["blocks"]:
            for span in text_instance["lines"]:
                for element in span["spans"]:
                    # Check if the text color is red
                    color = element.get("colorspace", [0, 0, 0])  # Default to black if color information is not available
                    if color[0] == 1.0 and color[1] == 0.0 and color[2] == 0.0:  # Red color
                        new_pdf.insert_page(-1, page)
                        break

    # Save the new PDF if at least one page was extracted
    if new_pdf.page_count > 0:
        new_pdf.save(output_path)
        print("Output PDF saved successfully.")
    else:
        print("No pages with red-colored text found.")

    new_pdf.close()

# Provide the path to the PDF file
pdf_path = "your_file.pdf"

# Specify the output path for the new PDF
output_pdf_path = "extracted_pages.pdf"

# Extract pages with red-colored text to a new PDF
extract_pages_with_red_text(pdf_path, output_pdf_path)
