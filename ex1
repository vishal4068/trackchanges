from docx import Document
from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import letter

def extract_pages_with_styles(docx_file):
    document = Document(docx_file)
    pages_with_styles = []
    current_page = ""
    for paragraph in document.paragraphs:
        if paragraph.text == "\n":
            if current_page:
                pages_with_styles.append(current_page.strip())
                current_page = ""
        else:
            current_page += paragraph.text + '\n'
    if current_page:
        pages_with_styles.append(current_page.strip())
    return pages_with_styles

def create_pdf(page_text, output_pdf):
    c = canvas.Canvas(output_pdf, pagesize=letter)
    width, height = letter
    c.drawString(50, height - 50, page_text)
    c.save()

if __name__ == "__main__":
    docx_file = "your_docx_file.docx"
    extracted_pages = extract_pages_with_styles(docx_file)
    
    for i, page_text in enumerate(extracted_pages):
        output_pdf = f"page_{i+1}_with_styles.pdf"
        create_pdf(page_text, output_pdf)
