from docx import Document
from PyPDF2 import PdfWriter
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas

def extract_track_changes(docx_file):
    document = Document(docx_file)
    pages_with_changes = []

    for i, paragraph in enumerate(document.paragraphs):
        for run in paragraph.runs:
            if run.element.rPr.rStyle and 'TrackChanges' in run.element.rPr.rStyle.val:
                pages_with_changes.append(i + 1)
                break  # Only need to add the page once

    return pages_with_changes

def create_pdf_with_changes(docx_file, output_pdf):
    pages_with_changes = extract_track_changes(docx_file)
    pdf_writer = PdfWriter()

    with open(output_pdf, "wb") as output:
        for page_num in pages_with_changes:
            c = canvas.Canvas(output_pdf, pagesize=letter)
            c.drawString(100, 750, f"Track Changes on Page {page_num}")
            c.save()
            pdf_writer.add_page(open(output_pdf, "rb"))

        pdf_writer.write(output)

docx_file = "your_docx_file.docx"
output_pdf = "output_with_changes.pdf"

create_pdf_with_changes(docx_file, output_pdf)
