from docx import Document
from lxml import etree

def identify_pages_with_changes(docx_file):
    document = Document(docx_file)
    xml_content = document._element.xml

    # Parse the XML content
    root = etree.fromstring(xml_content)

    # Define namespaces
    ns = {"w": "http://schemas.openxmlformats.org/wordprocessingml/2006/main"}

    # List to store pages with changes
    pages_with_changes = []

    # Iterate through paragraphs
    for i, paragraph in enumerate(root.xpath("//w:p", namespaces=ns)):
        # Check if any run has revision
        if any(paragraph.xpath(".//w:ins", namespaces=ns)) or any(paragraph.xpath(".//w:del", namespaces=ns)):
            pages_with_changes.append(i + 1)

    return pages_with_changes

docx_file = "your_docx_file.docx"
pages_with_changes = identify_pages_with_changes(docx_file)
print("Pages with track changes:", pages_with_changes)
