import os
import docx
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas

def extract_pages_with_track_changes(docx_file_path):
    doc = docx.Document(docx_file_path)
    pages_with_changes = []

    for i, para in enumerate(doc.paragraphs):
        if para._element.get('rsidRPr') or para._element.get('rsidR'):
            # Check if the paragraph has track changes (rsidRPr or rsidR)
            pages_with_changes.append(i + 1)  # Page numbers are 1-based

    return pages_with_changes

def create_pdf_from_pages(docx_file_path, pages_to_extract, output_pdf_path):
    c = canvas.Canvas(output_pdf_path, pagesize=letter)

    doc = docx.Document(docx_file_path)
    for page_num in pages_to_extract:
        c.drawString(100, 700, f"Page {page_num}")
        c.showPage()

    c.save()

if __name__ == "__main__":
    input_docx_path = "path/to/your/input.docx"
    output_pdf_path = "path/to/output.pdf"

    pages_with_changes = extract_pages_with_track_changes(input_docx_path)
    create_pdf_from_pages(input_docx_path, pages_with_changes, output_pdf_path)

    print(f"Extracted track change pages saved to {output_pdf_path}")
