from docx import Document
from PyPDF2 import PdfWriter
import re

def extract_pages_with_changes(docx_file, slug_line):
    document = Document(docx_file)
    pages_with_changes = []

    in_track_changes = False
    for i, paragraph in enumerate(document.paragraphs):
        text = paragraph.text.strip()
        if text.startswith(slug_line):
            in_track_changes = True
        elif in_track_changes and not text.startswith(slug_line):
            in_track_changes = False
            pages_with_changes.append(i + 1)

    return pages_with_changes

def print_pages_to_pdf(docx_file, output_pdf, slug_line):
    pages_with_changes = extract_pages_with_changes(docx_file, slug_line)
    pages_to_print = ','.join(str(page) for page in pages_with_changes)
    os.system(f'libreoffice --headless --invisible --convert-to pdf --outdir . --print-to-file {docx_file} {pages_to_print}')
    os.rename(f'{docx_file}.pdf', output_pdf)

docx_file = "your_docx_file.docx"
output_pdf = "output_with_changes.pdf"
slug_line = "Track Change Slug Line"

print_pages_to_pdf(docx_file, output_pdf, slug_line)
