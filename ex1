from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_COLOR_INDEX

def convert_docx_to_pdf_with_track_changes(docx_file, pdf_file):
    document = Document(docx_file)

    # Set track changes visible
    for paragraph in document.paragraphs:
        for run in paragraph.runs:
            # Check for inserted or deleted text
            if run.revision:
                # Set the font color to red for inserted text
                if run.revision.type == 1:
                    run.font.color.rgb = (255, 0, 0)  # Red
                # Apply strike-through for deleted text
                elif run.revision.type == 2:
                    run.font.strike = True
    
    # Save the modified document as PDF
    document.save(pdf_file)

if __name__ == "__main__":
    docx_file = "your_docx_file.docx"
    pdf_with_track_changes = "doc_with_track_changes.pdf"
    convert_docx_to_pdf_with_track_changes(docx_file, pdf_with_track_changes)
