import fitz  # PyMuPDF

def extract_pages_with_red_text(pdf_path, output_path):
    # Open the PDF
    pdf_document = fitz.open(pdf_path)

    # Create a new PDF
    new_pdf = fitz.open()

    # Iterate through each page of the PDF
    for page_number in range(pdf_document.page_count):
        page = pdf_document.load_page(page_number)
        
        # Extract text and styling information
        text_instances = page.get_text("dict")["blocks"]
        
        # Check for red-colored text
        red_text_found = False
        for block in text_instances:
            for line in block["lines"]:
                for span in line["spans"]:
                    color = span.get("color")
                    if color and isinstance(color, list) and len(color) == 3 and color[0] == 1.0:
                        red_text_found = True
                        break

        # If red text found, add the page to the new PDF
        if red_text_found:
            new_pdf.insert_page(-1, page)

    # Save the new PDF if at least one page was extracted
    if new_pdf.page_count > 0:
        new_pdf.save(output_path)
        print("Output PDF saved successfully.")
    else:
        print("No pages with red-colored text found.")

    new_pdf.close()

# Provide the path to the PDF file
pdf_path = "your_file.pdf"

# Specify the output path for the new PDF
output_pdf_path = "extracted_pages.pdf"

# Extract pages with red-colored text to a new PDF
extract_pages_with_red_text(pdf_path, output_pdf_path)
